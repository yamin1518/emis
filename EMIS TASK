#%%
import pandas as pd 
import os 
import glob 
import json

class Data_converter:

   
    def __init__(self):
        return
        
    def run_everything(self):
        self.load_data()
        self.convert_data()
        return

    def load_data(self):
        path = "/Users/yamz/Desktop/data/"
        self.json_files = os.path.join(path, '*.json')
        self.list_json = glob.glob(self.json_files)

        ##print(self.list_json)

       

    def convert_data(self): 
        
        dataframe = []

        for file in self.list_json: 
            with open(file) as f: 
                data = pd.json_normalize(json.loads(f.read()))
                data['resourceType'] = file.rsplit("/", 1)[-1]
                dataframe.append(data)
        dataframes = pd.concat(dataframe)
        print(dataframes)

        

        return



if __name__ == '__main__':
    convert = Data_converter()
    convert.run_everything()
